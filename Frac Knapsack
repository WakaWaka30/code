#include <stdio.h>
#include <stdlib.h>

float knapsack(float* profit, float* weight, int n, float maxwt){
    int i=0;
    float* profwt = (float*)malloc(n*sizeof(float));
    for(i=0;i<n;i++)
        *(profwt+i) = profit[i]/weight[i];
    float max=profwt[0];
    int maxid=0;
    float maxprofit=0,frac;
    
    while(1){
        max=0;
        for(i=0;i<n;i++)
            if(max<profwt[i]){
                max = profwt[i];
                maxid = i;
                
            }
        
        //printf("Highest pw ratio: %f\n",profwt[maxid]);
            
        
        if(weight[maxid] <= maxwt){
            maxprofit = maxprofit + profit[maxid]; 
            maxwt = maxwt - weight[maxid];
        }
        else{
            frac = maxwt/weight[maxid];
            
            maxprofit = maxprofit + (frac*profit[maxid]);
                
            maxwt = 0;
        }
        profwt[maxid] = -1;
        //printf("Remaining Capacity: %f\n",maxwt);
        if(maxwt == 0)
            break;
    }
        
    
    return maxprofit;
    
    
}

int main(){
    float *profit, *weight;
    float maxwt;
    printf("Enter number of items for knapsack: ");
    int n;
    scanf("%d",&n);
    printf("Enter maximum capacity of knapsack: ");
    scanf("%f",&maxwt);
    profit = (float*)malloc(n*sizeof(float));
    weight = (float*)malloc(n*sizeof(float));
    int i=0;
    printf("Enter profits and weights of each item:-\n");
    for(i=0;i<n;i++){
        printf("Enter profit for %dth item: ",i+1);
        scanf("%f",(profit+i));
        printf("Enter weight for %dth item: ",i+1);
        scanf("%f",(weight+i));
        if(*(weight+i)<=0.0){
            printf("Weight of an item cannot be zero");
            return 0;
        }
    }
    
    /*float* profwt = (float*)malloc(n*sizeof(float));
    for(i=0;i<n;i++)
        profwt[i] = profit[i]/weight[i];
    for(i=0;i<n;i++)
        printf("%f\n",*(profwt+i));*/
    float maxp = knapsack(profit,weight,n,maxwt);
    printf("Maximum profit for knapsack is %.2f",maxp);
    return 0;


}
